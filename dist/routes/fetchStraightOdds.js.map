{"version":3,"sources":["../../src/routes/fetchStraightOdds.js"],"names":["router","Router","use","oddHeader","JSON_ODD_KEY","post","authenticate","session","req","res","querys","body","straightOddArr","Promise","all","map","query","queryIdx","sport","oddType","replace","headers","result","json","odd","length","event","eventIdx","Details","detail","push","then","OddDetail","Odds","BetDetail","prevBetDetail","eventID","ID","WagerDetail","BetAmountInput","BetWagerType","BetConfirm","estWinAmount","estRiskAmount","wagerMsg","errMsg"],"mappings":";;;;;;AAAA;;;;AAEA;;;;AAEA;;;;AACA;;;;AAIA;;;;;;;;AARA,IAAMA,SAAS,kBAAQC,MAAR,EAAf;;;AAMA,mBAASC,GAAT;;AAGA,IAAMC,YAAY,EAAE,oBAAoB,iBAAOC,YAA7B,EAAlB;;AAEAJ,OAAOK,IAAP,CAAY,sBAAZ,EAAoC,mBAASC,YAAT,CAAsB,KAAtB,EAA6B,EAACC,SAAS,KAAV,EAA7B,CAApC,EAAoF,UAASC,GAAT,EAAcC,GAAd,EAAkB;AACrG,KAAMC,SAASF,IAAIG,IAAnB;AACA,KAAMC,iBAAiB,EAAvB;AACAC,SAAQC,GAAR,CAAYJ,OAAOK,GAAP;AAAA,uDAAW,kBAAeC,KAAf,EAAsBC,QAAtB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cACD,4DAAuCD,MAAME,KAA7C,0BAAuEF,MAAMG,OAAN,CAAcC,OAAd,CAAsB,KAAtB,EAA4B,EAA5B,CAAvE,EAA0G,EAACC,SAASlB,SAAV,EAA1G,CADC;;AAAA;AAChBmB,aADgB;AAAA;AAAA,cAEJA,OAAOC,IAAP,EAFI;;AAAA;AAEhBC,UAFgB;;AAAA,aAGnBA,IAAIC,MAAJ,GAAa,CAHM;AAAA;AAAA;AAAA;;AAIrBD,WAAIT,GAAJ;AAAA,8DAAQ,iBAAeW,KAAf,EAAsBC,QAAtB;AAAA;AAAA;AAAA;AAAA;AACP,iBAAGD,MAAME,OAAN,KAAkBZ,MAAMa,MAA3B,EAAkC;AACjCjB,6BAAekB,IAAf,CAAoBJ,KAApB;AACA;;AAHM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAR;;AAAA;AAAA;AAAA;AAAA;AAJqB;AAAA;;AAAA;AAAA;AAAA,cAUA,4DAAuCV,MAAME,KAA7C,0BAAuEF,MAAMG,OAAN,CAAcC,OAAd,CAAsB,KAAtB,EAA4B,EAA5B,CAAvE,EAA0G,EAACC,SAASlB,SAAV,EAA1G,CAVA;;AAAA;AAUfmB,cAVe;AAAA;AAAA,cAWHA,QAAOC,IAAP,EAXG;;AAAA;AAWfC,WAXe;;AAYrBA,YAAIT,GAAJ;AAAA,8DAAQ,kBAAeW,KAAf,EAAsBC,QAAtB;AAAA;AAAA;AAAA;AAAA;AACP,iBAAGD,MAAME,OAAN,KAAkBZ,MAAMa,MAA3B,EAAkC;AACjCjB,6BAAekB,IAAf,CAAoBJ,KAApB;AACA;;AAHM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAR;;AAAA;AAAA;AAAA;AAAA;;AAZqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAX;;AAAA;AAAA;AAAA;AAAA,KAAZ,EAkBIK,IAlBJ,CAkBS,YAAU;;AAGlBnB,iBAAeG,GAAf,CAAmB,UAASW,KAAT,EAAgBC,QAAhB,EAAyB;;AAE3CD,SAAMM,SAAN,GAAkBN,MAAMO,IAAN,CAAW,CAAX,CAAlB;AACAP,SAAMQ,SAAN,GAAkB,EAAlB;AACAR,SAAMS,aAAN,GAAsB,EAAtB;AACAT,SAAMU,OAAN,GAAgBV,MAAMW,EAAtB;AACAX,SAAMY,WAAN,GAAoB;AACnBC,oBAAgB,EADG;AAEnBC,kBAAc,OAFK;AAGnBC,gBAAY,KAHO;AAInBC,kBAAc,GAJK;AAKnBC,mBAAe,GALI;AAMnBC,cAAU,EANS;AAOnBC,YAAQ;AAPW,IAApB;AASA,UAAOnB,MAAMW,EAAb;AACA,UAAOX,MAAMM,SAAN,CAAgBK,EAAvB;AACA,UAAOX,MAAMO,IAAb;AACA,UAAOP,KAAP;AACA,GAnBD;AAoBAjB,MAAIc,IAAJ,CAASX,cAAT;AAGA,EA5CD;AA8CA,CAjDD;;kBAmDeZ,M","file":"fetchStraightOdds.js","sourcesContent":["import express from 'express';\nconst router = express.Router();\nimport fetch from 'node-fetch';\n\nimport JwtStrategy from '../middleware/jwtStrategy';\nimport passport from \"passport\";\n\npassport.use(JwtStrategy);\n\nimport config from '../data/config';\nconst oddHeader = { \"JsonOdds-API-Key\": config.JSON_ODD_KEY };\n\nrouter.post('/fetch-straight-odds', passport.authenticate('jwt', {session: false}), function(req, res){\n\tconst querys = req.body\n\tconst straightOddArr = []\n\tPromise.all(querys.map(async function(query, queryIdx){\n\t\tconst result = await fetch(`https://jsonodds.com/api/odds/${query.sport}?source=8&oddType=${query.oddType.replace(/\\s/g,'')}`, {headers: oddHeader})\n\t\tconst odd = await result.json()\n\t\tif(odd.length > 0){\n\t\t\todd.map(async function(event, eventIdx){\n\t\t\t\tif(event.Details === query.detail){\n\t\t\t\t\tstraightOddArr.push(event)\n\t\t\t\t}\n\t\t\t})\n\t\t}else{\n\t\t\tconst result = await fetch(`https://jsonodds.com/api/odds/${query.sport}?source=3&oddType=${query.oddType.replace(/\\s/g,'')}`, {headers: oddHeader})\n\t\t\tconst odd = await result.json()\n\t\t\todd.map(async function(event, eventIdx){\n\t\t\t\tif(event.Details === query.detail){\n\t\t\t\t\tstraightOddArr.push(event)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t})).then(function(){\n\n\n\t\tstraightOddArr.map(function(event, eventIdx){\n\n\t\t\tevent.OddDetail = event.Odds[0];\n\t\t\tevent.BetDetail = {};\n\t\t\tevent.prevBetDetail = {};\n\t\t\tevent.eventID = event.ID;\n\t\t\tevent.WagerDetail = {\n\t\t\t\tBetAmountInput: '', \n\t\t\t\tBetWagerType: 'Wager', \n\t\t\t\tBetConfirm: false, \n\t\t\t\testWinAmount: '0', \n\t\t\t\testRiskAmount: '0',\n\t\t\t\twagerMsg: '', \n\t\t\t\terrMsg: ''\n\t\t\t};\n\t\t\tdelete event.ID\n\t\t\tdelete event.OddDetail.ID\n\t\t\tdelete event.Odds;\n\t\t\treturn event\n\t\t})\n\t\tres.json(straightOddArr)\n\n\n\t})\n\n})\n\nexport default router"]}