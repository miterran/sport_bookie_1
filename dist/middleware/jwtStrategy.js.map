{"version":3,"sources":["../../src/middleware/jwtStrategy.js"],"names":["ExtractJwt","JwtStrategy","Strategy","jwtOptions","jwtFromRequest","fromAuthHeader","secretOrKey","TOKEN_SECRET","strategy","jwt_payload","next","findOne","username","err","user"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AACA,IAAMA,aAAa,sBAAYA,UAA/B;AACA,IAAMC,cAAc,sBAAYC,QAAhC;;AAGA,IAAIC,aAAa,EAAjB;AACAA,WAAWC,cAAX,GAA4BJ,WAAWK,cAAX,EAA5B;AACAF,WAAWG,WAAX,GAAyB,iBAAOC,YAAhC;;AAGA,IAAIC,WAAW,IAAIP,WAAJ,CAAgBE,UAAhB,EAA4B,UAASM,WAAT,EAAsBC,IAAtB,EAA4B;AACrE,iBAAKC,OAAL,CAAa,EAACC,UAAUH,YAAYG,QAAvB,EAAb,EAA+C,qPAA/C,EAAsS,UAASC,GAAT,EAAcC,IAAd,EAAmB;AACvT,QAAGA,IAAH,EAAQ;AACNJ,WAAK,IAAL,EAAWI,IAAX;AACD,KAFD,MAEK;AACHJ,WAAK,IAAL,EAAW,KAAX;AACD;AACF,GAND;AAOD,CARc,CAAf;;kBAUeF,Q","file":"jwtStrategy.js","sourcesContent":["import config from '../data/config';\nimport User from '../models/User';\nimport passport from \"passport\";\nimport passportJWT from \"passport-jwt\";\nconst ExtractJwt = passportJWT.ExtractJwt;\nconst JwtStrategy = passportJWT.Strategy;\n\n\nlet jwtOptions = {}\njwtOptions.jwtFromRequest = ExtractJwt.fromAuthHeader();\njwtOptions.secretOrKey = config.TOKEN_SECRET;\n\n\nlet strategy = new JwtStrategy(jwtOptions, function(jwt_payload, next) {\n  User.findOne({username: jwt_payload.username}, 'userStatus username passcode agent superAgent email phoneNumber minBetAmount maxBetAmount maxWinAmount weeklyBalance thisWeekBalance thisWeekLossAmount thisWeekWonAmount lastWeekBalance lastWeekLossAmount lastWeekWonAmount currentOpenBetAmount', function(err, user){\n    if(user){\n      next(null, user);\n    }else{\n      next(null, false)\n    }\n  })\n});\n\nexport default strategy"]}